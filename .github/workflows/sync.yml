name: Sync File

on:
  schedule:
    - cron: '0 1 * * *'  # 每天 UTC 时间 1:00 运行

jobs:
  sync:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v2

      - name: Download file
        run: |
          curl -o vless.js https://raw.githubusercontent.com/yonggekkk/Cloudflare_vless_trojan/main/Vless_workers_pages/vless%E4%BB%85nat64%E5%A5%97%E5%A3%B3%E7%89%88%20(%E6%8E%A8%E8%8D%90%E4%BD%BF%E7%94%A8).js

      - name: Check for changes
        run: |
          git diff --quiet vless.js || echo "File changed" > /tmp/changed

      - name: Commit and push if changed
        if: hashFiles('/tmp/changed') != ''
        run: |
          git config --global user.name 'GitHub Action'
          git config --global user.email 'action@github.com'
          git add vless.js
          git commit -m "Sync vless.js from source repository"
          git push
